{#  {% extends 'base.html.twig' %} #}
  {% block stylesheet %}
      <link href="{{ asset('vendor/bootstrap/css/bootstrap.min.css') }}" rel="stylesheet">


      <!-- Additional CSS Files -->
      <link rel="stylesheet" href="{{ asset('assets/css/fontawesome.css') }}">
      <link rel="stylesheet" href="{{ asset('assets/css/templatemo-liberty-market.css') }}">
      <link rel="stylesheet" href="{{ asset('assets/css/owl.css') }}">
      <link rel="stylesheet" href="{{ asset('assets/css/animate.css') }}">
      <link rel="stylesheet" href='https://unpkg.com/swiper@7/swiper-bundle.min.css'/>
      <style>
          .dropdown {
              position: relative;
              display: inline-block;
          }

          .dropbtn {

              padding: 12px;
              font-size: 16px;
              border: none;
              cursor: pointer;
          }

          .dropdown-content {
              display: none;
              position: absolute;
              z-index: 1;
          }

          .dropdown-submenu {
              position: relative;
          }

          .dropdown-submenu:hover .dropdown-submenu-content {
              display: block;
          }

          .dropdown-submenu-content {
              display: none;
              position: absolute;
              left: 100%;
              top: 0;
              margin-top: -1px;
          }

          .dropdown-content a {

              padding: 12px 16px;
              text-decoration: none;
              display: block;
          }

          .dropdown-content a:hover {

          }

          .dropdown:hover .dropdown-content {
              display: block;
          }

          .dropdown:hover .dropbtn {

          }
      </style>
  {% endblock %}
{% block title %}Challenge{% endblock %}

{% block css %}
    {# {{ parent() }} #}
    <style>
        html {
            scroll-behavior: smooth;
        }

        .winner-card {
            margin-bottom: 30px;
            padding: 20px;
            text-align: center;
            background-color: #7453FC;
            color: #FFFFFF;
            border-radius: 10px;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
            transition: 0.3s;
            display: inline-block;
            min-width: 250px;
        }

        .winner-card:hover {
            box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
        }

        .winner-card-title {
            margin-bottom: 20px;
            font-size: 2rem;
            font-weight: bold;
        }

        .item-details-page p {
            margin-bottom: 5px;
        }

        .winner-picture {
            max-width: 200px;
            max-height: 200px;
            height: auto;
            margin-bottom: 20px;
            border-radius: 50%;
            border: 5px solid #FFFFFF;
        }

        .purple-text {
            color: #b6a9e6;
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .rating {
            font-size: 1.5rem;
            color: #F5B041;
            font-weight: bold;
        }

        .page-title {
            text-align: center;
            font-size: 3rem;
            font-weight: bold;
            color: #7453FC;
            margin-top: 50px;
            margin-bottom: 50px;
            margin-top: 150px;
        }
    </style>
{% endblock %}


{% block body %}
    <header class="header-area header-sticky">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <nav class="main-nav">
                        <!-- ***** Logo Start ***** -->
                        <a href="{{ path('app_home') }}" class="logo">
                            <img src={{ asset("assets/images/logo.png") }} alt="">
                        </a>
                        <!-- ***** Logo End ***** -->
                        <!-- ***** Menu Start ***** -->
                        <ul class="nav">
                            <div class="dropdown">
                                <li><a>Art</a></li>
                                <div class="dropdown-content">
                                    <li><a href="{{ path('app_explore') }}">Explore</a></li>
                                    <li><a href="{{ path('app_blog') }}">Blog</a></li>
                                    <li><a href="{{ path('app_map') }}">Studios</a></li>
                                    <li><a href="{{ path('app_post_new') }}">Create Yours</a></li>

                                </div>
                            </div>
                            {% if(user.type=='Studio') %}
                                <li><a href="{{ path('app_offretravail_index') }}">Offres</a></li>
                            {% elseif(user.type=='Artist') %}

                                <li><a href="{{ path('app_demandetravail_index') }}">Demandes</a></li>
                            {% endif %}
                            <li><a href="{{ path('app_produits_index') }}">Shop</a></li>
                            <li><a href="{{ path('app_panier_show' , {'idpanier': '1'}) }}">Panier</a></li>
                            <li><a href="{{ path('app_challenge_index') }}">Challenges</a></li>
                            <li><a href="{{ path('app_tutoriel_index') }}">Tutoriels</a></li>
                            {%if(user.type!='Observer') %}
                                <li><a href="{{ path('app_dashboard_studiodashboard') }}">dashboard </a></li>
                            {% endif %}
                            {% if(user.idUser is null) %}
                                <li><a href="{{ path('app_allusers_login') }}">Log In</a></li>
                            {% else %}
                                <li><a href="{{ path('app_allusers_logout') }}">Logout</a></li>
                            {% endif %}
                        </ul>
                        <!-- ***** Menu End ***** -->
                    </nav>
                </div>
            </div>
        </div>
    </header>
    <div class="page-heading normal-space">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    {% for message in app.flashes('warning') %}
                        <div class="alert alert-warning">
                            {{ message }}</i>
                        </div>
                    {% endfor %}
                    {% for message in app.flashes('success') %}
                        <div class="alert alert-success">
                            {{ message }}
                        </div>
                    {% endfor %}
                    <h6><span>{{ challenge.DateC ? challenge.DateC|date('d M Y') : '' }}</span></h6>
                    <h2>{{ challenge.Title }}</h2>
                    <img src={{ asset('http://localhost/img/'~challenge.PathIMG) }} alt=""
                         style="border-radius: 20px; max-width: 200px;" height=200>
                    <h6>{{ challenge.Description }}</h6>
                    <span>Level : {{ challenge.Niveau }}</span>
                    <div class="buttons">
                        <div class="main-button">
                            <a href="#section1">Participer</a>
                        </div>
                        <div class="border-button">
                            <a href="#section2">Show Participations</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {{ form_start(form,{'attr': {'novalidate': 'novalidate'}} ) }}
    <div class="item-details-page" id="section1">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="section-heading">
                        <div class="line-dec"></div>
                        <h2>Apply For <em>Your Participation</em> Here.</h2>
                    </div>
                </div>
                <div class="col-lg-12">

                    <div class="row" style="color:white; margin-top:20px">
                        <div class="col-lg-12">
                            <fieldset>
                                <label style="color:white;" for={{ form.Description.vars.id }}>Description</label>
                                <input style="width: 100%; background:transparent; border-color:#7453FC; border-radius: 25px; padding:5px;color:white;border-width: 10px; margin-top:5px;"
                                       type="title" value="{{ form.Description.vars.value }}"
                                       name={{ form.Description.vars.full_name }} id={{ form.Description.vars.id }}
                                       placeholder="Ex. Lyon King" autocomplete="on" required>
                                {% do form.Description.setRendered %}
                            </fieldset>
                        </div>

                        <div class="col-lg-4" style="margin-top:20px">
                            <fieldset>
                                <label style="color:white;" for={{ form.Image.vars.id }}>Your Image</label>
                                <input style="background-color:#7453FC; cursor:pointer;border-color:#7453FC; border-radius: 20px; padding:10px; padding-left:20px; color:white;border-width: 10px; width:100%; height:100%; margin-top:5px"
                                       type="file" id={{ form.Image.vars.id }} name={{ form.Image.vars.full_name }} />
                                {% do form.Image.setRendered %}
                            </fieldset>
                        </div>

                        <div class="col-lg-12" style="margin-top:20px">
                            <fieldset style="display:flex; justify-content:center;">
                                <button type="submit" id="form" class="orange-button">Submit Your Applying</button>
                            </fieldset>
                        </div>

                    </div>

                </div>
                {{ form_end(form) }}

                {% if(best|length>0) %}

                    <h1 class="page-title">Challenge Best</h1>
                    <div class="winner-container container">
                        <div class="row justify-content-center">

                            <div class="col-md-4">
                                <div class="winner-card">
                                    <a href="{{ path('app_participation_show',{'id_participation': best[0].id_participation }) }}"><img
                                                class="winner-picture"
                                                src="{{ asset('http://localhost/img/'~best[0].img_participation) }}"
                                                alt="John Smith"></a>
                                    <h3 class="winner-card-title">First Place</h3>
                                    <p class="purple-text">{{ best[0].name }} {{ best[0].Last_Name }}</p>
                                    <p>Rating: <span class="rating">{{ best[0].average|round(1) }}</span></p>
                                    {% if best[0].numberRaters!=0 %}
                                        <p>Raters: <span class="rating">{{ best[0].numberRaters }}</span></p>
                                    {% endif %}
                                </div>
                            </div>
                            {% if(best|length>1) %}

                                <div class="col-md-4">
                                    <div class="winner-card">
                                        <a href="{{ path('app_participation_show',{'id_participation': best[1].id_participation }) }}"><img
                                                    class="winner-picture"
                                                    src="{{ asset('http://localhost/img/'~best[1].img_participation) }}"
                                                    alt="Jane Doe"></a>
                                        <h3 class="winner-card-title">Second Place</h3>
                                        <p class="purple-text">{{ best[1].name }} {{ best[1].Last_Name }}</p>
                                        <p>Rating: <span class="rating">{{ best[1].average|round(1) }}</span></p>
                                        {% if best[1].numberRaters!=0 %}
                                            <p>Raters: <span class="rating">{{ best[1].numberRaters }}</span></p>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endif %}

                            {% if(best|length>2) %}
                                <div class="col-md-4">
                                    <div class="winner-card">
                                        <a href="{{ path('app_participation_show',{'id_participation': best[2].id_participation }) }}"><img
                                                    class="winner-picture"
                                                    src="{{ asset('http://localhost/img/'~best[2].img_participation) }}"
                                                    alt="Bob Johnson"></a>
                                        <h3 class="winner-card-title">Third Place</h3>
                                        <p class="purple-text">{{ best[2].name }} {{ best[2].Last_Name }}</p>
                                        <p>Rating: <span class="rating">{{ best[2].average|round(1) }}</span></p>
                                        {% if best[2].numberRaters!=0 %}
                                            <p>Raters: <span class="rating">{{ best[2].numberRaters }}</span></p>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                {% endif %}

                <div class="col-lg-12" id="section2">
                    <div class="current-bid">
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="section-heading">
                                    <h2>This Is The List Of <em>Participations</em></h2>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <fieldset>
                                    <select name="Category" class="form-select" aria-label="Default select example"
                                            id="chooseCategory" onchange="this.form.click()">
                                        <option selected>Sort By: Latest</option>
                                        <option type="checkbox" name="option1" value="old">Sort By: Oldest</option>
                                        <option value="low">Sort By: Lowest</option>
                                        <option value="high">Sort By: Highest</option>
                                    </select>
                                </fieldset>
                            </div>

                            {% for p in challenge.participations %}

                                {% set k = 0 %}
                                {% set n = 0 %}
                                {% for r in challenge.ratings %}
                                    {% if(r.getParticipatorId().getid_user() == p.getIdUser.getid_user() ) %}

                                        {% set k = k + r.getRating() %}
                                        {% set n = n+1 %}
                                    {% endif %}

                                {% endfor %}
                                {% if n!=0 %}
                                    {% set m = k/n %}
                                {% else %}
                                    {% set m = 0 %}
                                {% endif %}

                                <div class="col-lg-4 col-md-6">
                                    <div class="item">
                                        <div class="left-img">
                                            <img src="{{ asset('http://localhost/img/'~p.getIMGParticipation()) }}"
                                                 alt="">
                                        </div>
                                        <div class="right-content">
                                            <h6>{{ p.getIdUser().getName()|capitalize }} {{ p.getIdUser().getLastName()|capitalize }}</h6>
                                            <a href="#">@{{ p.getIdUser().getEmail() }}</a>
                                            <div class="line-dec"></div>
                                            {% if k!=0 %}
                                                <h6>Rating: <em>{{ m }} Stars</em></h6>
                                            {% else %}
                                                <h6><em>not rated</em> yet</h6>
                                            {% endif %}

                                            {% if k!=0 %}
                                                <h6>Raters: <em> {{ n }} </em></h6>
                                            {% endif %}

                                            <a class="border-button"
                                               href="{{ path('app_participation_show',{'id_participation': p.getId() }) }}">
                                                Show </a>
                                        </div>
                                    </div>
                                </div>

                            {% else %}
                                <p> no Participation Yet </p>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    </div>
    </div>

    </div>
    </div>
    </div>
    {% block javascripts %}
        {# <script src="vendor/jquery/jquery.min.js"></script> #}
        <script src="{{ asset('vendor/jquery/jquery.min.js') }}"></script>

        {# <script src="vendor/bootstrap/js/bootstrap.min.js"></script> #}
        <script src="{{ asset('vendor/bootstrap/js/bootstrap.min.js') }}"></script>

        {# <script src="assets/js/isotope.min.js"></script> #}
        <script src="{{ asset('assets/js/isotope.min.js') }}"></script>

        {# <script src="assets/js/owl-carousel.js"></script> #}
        <script src="{{ asset('assets/js/owl-carousel.js') }}"></script>

        {# <script src="assets/js/tabs.js"></script> #}
        <script src="{{ asset('assets/js/tabs.js') }}"></script>

        {# <script src="assets/js/popup.js"></script> #}
        <script src="{{ asset('assets/js/popup.js') }}"></script>

        {# <script src="assets/js/custom.js"></script>  #}
        <script src="{{ asset('assets/js/custom.js') }}"></script>
    {% endblock %}

{% endblock %}